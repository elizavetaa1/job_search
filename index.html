<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢—Ä–µ–∫–µ—Ä –æ—Ç–∫–ª–∏–∫–æ–≤ –Ω–∞ –≤–∞–∫–∞–Ω—Å–∏–∏</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 20px;
            text-align: center;   
        }

        h1 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 32px;
        }

        .subtitle {
            color: #666;
            font-size: 16px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            text-align: center;
        }

        .stat-number {
            font-size: 36px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #666;
            font-size: 14px;
        }

        .stat-card:nth-child(1) .stat-number { color: #667eea; }
        .stat-card:nth-child(2) .stat-number { color: #4CAF50; }
        .stat-card:nth-child(3) .stat-number { color: #FFC107; }
        .stat-card:nth-child(4) .stat-number { color: #f44336; }
        .stat-card:nth-child(5) .stat-number { color: #9C27B0; }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 20px;
        }

        .table-container {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow-x: auto;
        }

        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            height: fit-content;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            position: sticky;
            top: 0;
        }

        td {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
    vertical-align: middle;
        }

        tr:hover {
            background-color: #f5f5f5;
        }

        .company-name {
            font-weight: 600;
            color: #333;
        }

        .sector {
            font-size: 12px;
            color: #666;
            display: block;
            margin-top: 3px;
        }

        select {
            width: 100%;
            padding: 8px;
            border: 2px solid #ddd;
            border-radius: 8px;
            background: white;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
        }

        select:hover {
            border-color: #667eea;
        }

        select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .status-–Ω–µ-–æ—Ç–ø—Ä–∞–≤–ª–µ–Ω { 
            background-color: #e8eaf6; 
            color: #3f51b5; 
            border: 2px solid #3f51b5;
        }
        .status-–æ—Ç–ø—Ä–∞–≤–ª–µ–Ω { 
            background-color: #e1f5fe; 
            color: #0277bd; 
            border: 2px solid #0277bd;
        }
        .status-–ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω { 
            background-color: #fff3e0; 
            color: #f57c00; 
            border: 2px solid #f57c00;
            font-weight: 600;
        }
        .status-–∏–Ω—Ç–µ—Ä–≤—å—é { 
            background-color: #fff9c4; 
            color: #f9a825; 
            border: 2px solid #f9a825;
            font-weight: 600;
        }
        .status-–æ—Ñ—Ñ–µ—Ä { 
            background-color: #c8e6c9; 
            color: #2e7d32; 
            border: 2px solid #2e7d32;
            font-weight: bold;
            box-shadow: 0 2px 8px rgba(46, 125, 50, 0.3);
        }
        .status-–æ—Ç–∫–∞–∑ { 
            background-color: #ffcdd2; 
            color: #c62828; 
            border: 2px solid #c62828;
            font-weight: 600;
        }

        input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: #667eea;
        }

        .filters {
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 10px 20px;
            border: 2px solid white;
            background: rgba(255,255,255,0.2);
            color: white;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }

        .filter-btn:hover, .filter-btn.active {
            background: white;
            color: #667eea;
        }

        .export-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .export-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: transform 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .export-btn.excel {
            background: linear-gradient(135deg, #1D6F42 0%, #0F4C29 100%);
        }

        .export-btn.word {
            background: linear-gradient(135deg, #2B579A 0%, #1B3B6F 100%);
        }

        .export-btn.pdf {
            background: linear-gradient(135deg, #DC143C 0%, #8B0000 100%);
        }

        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 500px;
            text-align: center;
        }

        .modal-content h2 {
            color: #667eea;
            margin-bottom: 20px;
        }

        .modal-content p {
            color: #666;
            margin-bottom: 20px;
        }

        .close-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéØ –¢—Ä–µ–∫–µ—Ä –æ—Ç–∫–ª–∏–∫–æ–≤ –Ω–∞ –≤–∞–∫–∞–Ω—Å–∏–∏</h1>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number" id="totalCompanies">75</div>
                <div class="stat-label">–í—Å–µ–≥–æ –∫–æ–º–ø–∞–Ω–∏–π</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="sentCount">0</div>
                <div class="stat-label">–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –æ—Ç–∫–ª–∏–∫–æ–≤</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="inProgressCount">0</div>
                <div class="stat-label">–í –ø—Ä–æ—Ü–µ—Å—Å–µ</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="rejectedCount">0</div>
                <div class="stat-label">–û—Ç–∫–∞–∑–æ–≤</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="offerCount">0</div>
                <div class="stat-label">–û—Ñ—Ñ–µ—Ä–æ–≤</div>
            </div>
        </div>

        <div class="filters">
            <button class="filter-btn active" onclick="filterBySector('all')">–í—Å–µ</button>
            <button class="filter-btn" onclick="filterBySector('–§–∏–Ω–∞–Ω—Å—ã')">–§–∏–Ω–∞–Ω—Å—ã</button>
            <button class="filter-btn" onclick="filterBySector('–†–∏—Ç–µ–π–ª')">–†–∏—Ç–µ–π–ª</button>
            <button class="filter-btn" onclick="filterBySector('IT')">IT</button>
            <button class="filter-btn" onclick="filterBySector('–ú–µ–¥–∏—Ü–∏–Ω–∞')">–ú–µ–¥–∏—Ü–∏–Ω–∞</button>
            <button class="filter-btn" onclick="filterBySector('–¢–µ–ª–µ–∫–æ–º')">–¢–µ–ª–µ–∫–æ–º</button>
            <button class="filter-btn" onclick="filterBySector('–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞')">–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞</button>
        </div>
<div class="add-company" style="margin-bottom:20px; background:white; padding:20px; border-radius:15px; box-shadow:0 5px 15px rgba(0,0,0,0.1);">
    <h3 style="margin-bottom:10px; color:#667eea;">‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –∫–æ–º–ø–∞–Ω–∏—é</h3>
    
    <div style="display:flex; gap:10px; flex-wrap:wrap;">
        <input id="newCompanyName" type="text" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏" 
               style="flex:1; padding:10px; border:2px solid #ddd; border-radius:8px;">

        <input id="newCompanySector" type="text" placeholder="–°–µ–∫—Ç–æ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä: IT)" 
               style="flex:1; padding:10px; border:2px solid #ddd; border-radius:8px;">

        <button onclick="addNewCompany()" 
                style="padding:10px 20px; background:#667eea; color:white; border:none; border-radius:8px; cursor:pointer; font-weight:600;">
            –î–æ–±–∞–≤–∏—Ç—å
        </button>
    </div>
</div>

        <div class="main-content">
            <div class="table-container">
                <table id="jobTable">
                    <thead>
                        <tr>
                            <th>‚Ññ</th>
                            <th>–ö–æ–º–ø–∞–Ω–∏—è</th>
                            <th style="text-align: center;">–û—Ç–∫–ª–∏–∫ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω</th>
                            <th>–°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏</th>
                            <th>–ó–∞–º–µ—Ç–∫–∏</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                    </tbody>
                </table>
                
                <div class="export-buttons">
                    <button class="export-btn" onclick="exportToCSV()">
                        üìä CSV (–¥–ª—è Google –¢–∞–±–ª–∏—Ü)
                    </button>
                    <button class="export-btn excel" onclick="exportToExcel()">
                        üìó Excel (XLSX)
                    </button>
                    <button class="export-btn word" onclick="exportToWord()">
                        üìò Word (DOC)
                    </button>
                    <button class="export-btn pdf" onclick="printToPDF()">
                        üìï –ü–µ—á–∞—Ç—å/PDF
                    </button>
                </div>
            </div>

            <div class="chart-container">
                <h3 style="margin-bottom: 20px; color: #667eea;">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Ç–∫–ª–∏–∫–æ–≤</h3>
                <canvas id="statusChart"></canvas>
            </div>
        </div>
    </div>

    <div class="modal" id="exportModal">
        <div class="modal-content">
            <h2>‚úÖ –§–∞–π–ª –≥–æ—Ç–æ–≤!</h2>
            <p id="modalMessage">–í–∞—à —Ñ–∞–π–ª —É—Å–ø–µ—à–Ω–æ —Å–∫–∞—á–∞–Ω</p>
            <button class="close-btn" onclick="closeModal()">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <script>
        const companies = [
            {name: "–ê–ª—å—Ñ–∞-–ë–∞–Ω–∫", sector: "–§–∏–Ω–∞–Ω—Å—ã"},
            {name: "–í–¢–ë", sector: "–§–∏–Ω–∞–Ω—Å—ã"},
            {name: "–°–±–µ—Ä–±–∞–Ω–∫", sector: "–§–∏–Ω–∞–Ω—Å—ã"},
            {name: "–¢–∏–Ω—å–∫–æ—Ñ—Ñ", sector: "–§–∏–Ω–∞–Ω—Å—ã"},
            {name: "X5 Group", sector: "–†–∏—Ç–µ–π–ª"},
            {name: "Wildberries", sector: "–†–∏—Ç–µ–π–ª"},
            {name: "Ozon", sector: "–†–∏—Ç–µ–π–ª"},
            {name: "–Ø–Ω–¥–µ–∫—Å", sector: "IT"},
            {name: "–ê–≤–∏—Ç–æ", sector: "IT"},
            {name: "VK (–í–ö–æ–Ω—Ç–∞–∫—Ç–µ)", sector: "IT"},
            {name: "Mars", sector: "–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ"},
            {name: "–°–ú-–ö–ª–∏–Ω–∏–∫–∞", sector: "–ú–µ–¥–∏—Ü–∏–Ω–∞"},
            {name: "–ö–æ–Ω—Ç—É—Ä", sector: "IT"},
            {name: "Level Group", sector: "–î–µ–≤–µ–ª–æ–ø–º–µ–Ω—Ç"},
            {name: "–ù–õ–ú–ö", sector: "–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ"},
            {name: "–°–ò–ë–£–†", sector: "–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞"},
            {name: "–ù–æ—Ä–Ω–∏–∫–µ–ª—å", sector: "–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ"},
            {name: "–†–£–°–ê–õ", sector: "–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ"},
            {name: "–ì–∞–∑–ø—Ä–æ–º", sector: "–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞"},
            {name: "–†–æ—Å–Ω–µ—Ñ—Ç—å", sector: "–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞"},
            {name: "–õ–£–ö–û–ô–õ", sector: "–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞"},
            {name: "–¢–∞—Ç–Ω–µ—Ñ—Ç—å", sector: "–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞"},
            {name: "–†–æ—Å–∞—Ç–æ–º", sector: "–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞"},
            {name: "–¢—Ä–∞–Ω—Å–Ω–µ—Ñ—Ç—å", sector: "–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞"},
            {name: "–†–ñ–î", sector: "–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç"},
            {name: "–ú–¢–°", sector: "–¢–µ–ª–µ–∫–æ–º"},
            {name: "–ú–µ–≥–∞–§–æ–Ω", sector: "–¢–µ–ª–µ–∫–æ–º"},
            {name: "–ë–∏–ª–∞–π–Ω", sector: "–¢–µ–ª–µ–∫–æ–º"},
            {name: "–¢–µ–ª–µ2", sector: "–¢–µ–ª–µ–∫–æ–º"},
            {name: "–†–æ—Å—Ç–µ–ª–µ–∫–æ–º", sector: "–¢–µ–ª–µ–∫–æ–º"},
            {name: "–°–æ–≤–∫–æ–º–±–∞–Ω–∫", sector: "–§–∏–Ω–∞–Ω—Å—ã"},
            {name: "–û—Ç–∫—Ä—ã—Ç–∏–µ", sector: "–§–∏–Ω–∞–Ω—Å—ã"},
            {name: "–†–∞–π—Ñ—Ñ–∞–π–∑–µ–Ω –ë–∞–Ω–∫", sector: "–§–∏–Ω–∞–Ω—Å—ã"},
            {name: "–†–æ—Å—Å–µ–ª—å—Ö–æ–∑–±–∞–Ω–∫", sector: "–§–∏–Ω–∞–Ω—Å—ã"},
            {name: "–ú–∞–≥–Ω–∏—Ç", sector: "–†–∏—Ç–µ–π–ª"},
            {name: "–õ–µ–Ω—Ç–∞", sector: "–†–∏—Ç–µ–π–ª"},
            {name: "–î–µ—Ç—Å–∫–∏–π –º–∏—Ä", sector: "–†–∏—Ç–µ–π–ª"},
            {name: "–°–ø–æ—Ä—Ç–º–∞—Å—Ç–µ—Ä", sector: "–†–∏—Ç–µ–π–ª"},
            {name: "–õ'–≠—Ç—É–∞–ª—å", sector: "–†–∏—Ç–µ–π–ª"},
            {name: "–ê–∑–±—É–∫–∞ –í–∫—É—Å–∞", sector: "–†–∏—Ç–µ–π–ª"},
            {name: "–ö—Ä–∞—Å–Ω–æ–µ&–ë–µ–ª–æ–µ", sector: "–†–∏—Ç–µ–π–ª"},
            {name: "–í–∫—É—Å–Ω–æ ‚Äì –∏ —Ç–æ—á–∫–∞", sector: "–û–±—â–µ–ø–∏—Ç"},
            {name: "KFC", sector: "–û–±—â–µ–ø–∏—Ç"},
            {name: "Burger King", sector: "–û–±—â–µ–ø–∏—Ç"},
            {name: "–î–æ–¥–æ –ü–∏—Ü—Ü–∞", sector: "–û–±—â–µ–ø–∏—Ç"},
            {name: "–Ø–Ω–¥–µ–∫—Å –ï–¥–∞", sector: "–û–±—â–µ–ø–∏—Ç"},
            {name: "–°–î–≠–ö", sector: "–õ–æ–≥–∏—Å—Ç–∏–∫–∞"},
            {name: "–ü–æ—á—Ç–∞ –†–æ—Å—Å–∏–∏", sector: "–õ–æ–≥–∏—Å—Ç–∏–∫–∞"},
            {name: "–ü–≠–ö", sector: "–õ–æ–≥–∏—Å—Ç–∏–∫–∞"},
            {name: "–î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏", sector: "–õ–æ–≥–∏—Å—Ç–∏–∫–∞"},
            {name: "–ü–ò–ö", sector: "–î–µ–≤–µ–ª–æ–ø–º–µ–Ω—Ç"},
            {name: "–°–∞–º–æ–ª–µ—Ç", sector: "–î–µ–≤–µ–ª–æ–ø–º–µ–Ω—Ç"},
            {name: "–õ–°–†", sector: "–î–µ–≤–µ–ª–æ–ø–º–µ–Ω—Ç"},
            {name: "–ò–≤–∏ (ivi)", sector: "IT"},
            {name: "–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è –ö–∞—Å–ø–µ—Ä—Å–∫–æ–≥–æ", sector: "IT"},
            {name: "–†–∞–º–±–ª–µ—Ä", sector: "IT"},
            {name: "–¶–∏–∞–Ω", sector: "IT"},
            {name: "–ú–µ–¥—Å–∏", sector: "–ú–µ–¥–∏—Ü–∏–Ω–∞"},
            {name: "–ò–Ω–≤–∏—Ç—Ä–æ", sector: "–ú–µ–¥–∏—Ü–∏–Ω–∞"},
            {name: "–ì–µ–º–æ—Ç–µ—Å—Ç", sector: "–ú–µ–¥–∏—Ü–∏–Ω–∞"},
            {name: "–†-–§–∞—Ä–º", sector: "–ú–µ–¥–∏—Ü–∏–Ω–∞"},
            {name: "–ü—Ä–æ—Ç–µ–∫", sector: "–ú–µ–¥–∏—Ü–∏–Ω–∞"},
            {name: "–ê—ç—Ä–æ—Ñ–ª–æ—Ç", sector: "–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç"},
            {name: "S7 Airlines", sector: "–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç"},
            {name: "–ê–∑–∏–º—É—Ç –û—Ç–µ–ª–∏", sector: "–ì–æ—Å—Ç–∏–Ω–∏—Ü—ã"},
            {name: "–ö—Ä–∞—Å–Ω–∞—è –ü–æ–ª—è–Ω–∞", sector: "–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è"},
            {name: "Unilever –†–æ—Å—Å–∏—è", sector: "–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ"},
            {name: "Danone –†–æ—Å—Å–∏—è", sector: "–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ"},
            {name: "Coca-Cola HBC", sector: "–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ"},
            {name: "PepsiCo –†–æ—Å—Å–∏—è", sector: "–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ"},
            {name: "Delivery Club", sector: "–û–±—â–µ–ø–∏—Ç"},
            {name: "–ú.–í–∏–¥–µ–æ-–≠–ª—å–¥–æ—Ä–∞–¥–æ", sector: "–†–∏—Ç–µ–π–ª"},
            {name: "Fix Price", sector: "–†–∏—Ç–µ–π–ª"},
            {name: "–õ–µ—Ä—É–∞ –ú–µ—Ä–ª–µ–Ω", sector: "–†–∏—Ç–µ–π–ª"},
            {name: "–û–ë–ò", sector: "–†–∏—Ç–µ–π–ª"}
        ];

        let jobData = [];
        let currentFilter = 'all';

        function initializeData() {
            const saved = localStorage.getItem('jobTrackerData');
            if (saved) {
                jobData = JSON.parse(saved);
            } else {
                jobData = companies.map((company, index) => ({
                    id: index,
                    name: company.name,
                    sector: company.sector,
                    applied: false,
                    status: '–ù–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω',
                    notes: ''
                }));
                saveData();
            }
        }

        function saveData() {
            localStorage.setItem('jobTrackerData', JSON.stringify(jobData));
        }

        function renderTable() {
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = '';
            
            const filteredData = currentFilter === 'all' 
                ? jobData 
                : jobData.filter(job => job.sector === currentFilter);

            filteredData.forEach((job) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${job.id + 1}</td>
                    <td>
                        <span class="company-name">${job.name}</span>
                        <span class="sector">${job.sector}</span>
                    </td>
<td style="text-align: center;">
                        <input type="checkbox" ${job.applied ? 'checked' : ''} 
                               onchange="toggleApplied(${job.id})">
                    </td>
                    <td style="vertical-align: middle;">
                        <select onchange="updateStatus(${job.id}, this.value)" class="status-${job.status.toLowerCase().replace(' ', '-')}">
                            <option value="–ù–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω" ${job.status === '–ù–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω' ? 'selected' : ''}>–ù–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω</option>
                            <option value="–û—Ç–ø—Ä–∞–≤–ª–µ–Ω" ${job.status === '–û—Ç–ø—Ä–∞–≤–ª–µ–Ω' ? 'selected' : ''}>–û—Ç–ø—Ä–∞–≤–ª–µ–Ω</option>
                            <option value="–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω" ${job.status === '–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω' ? 'selected' : ''}>–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω</option>
                            <option value="–ò–Ω—Ç–µ—Ä–≤—å—é" ${job.status === '–ò–Ω—Ç–µ—Ä–≤—å—é' ? 'selected' : ''}>–ò–Ω—Ç–µ—Ä–≤—å—é</option>
                            <option value="–û—Ñ—Ñ–µ—Ä" ${job.status === '–û—Ñ—Ñ–µ—Ä' ? 'selected' : ''}>–û—Ñ—Ñ–µ—Ä</option>
                            <option value="–û—Ç–∫–∞–∑" ${job.status === '–û—Ç–∫–∞–∑' ? 'selected' : ''}>–û—Ç–∫–∞–∑</option>
                        </select>
</td>
                    <td>
    <div style="display: flex; gap: 10px; align-items: center;">
        <input type="text" value="${job.notes}" 
               onchange="updateNotes(${job.id}, this.value)"
               placeholder="–î–æ–±–∞–≤–∏—Ç—å –∑–∞–º–µ—Ç–∫—É..."
               style="flex: 1; padding: 6px; border: 1px solid #ddd; border-radius: 5px;">
        <button onclick="deleteCompany(${job.id})" 
                style="background:#f44336; color:white; border:none; padding:6px 12px; border-radius:5px; cursor:pointer; font-weight:600; white-space: nowrap;"
                onmouseover="this.style.background='#d32f2f'"
                onmouseout="this.style.background='#f44336'">
            üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
        </button>
    </div>
</td>
                `;
                tbody.appendChild(row);
            });

            updateStats();
            updateChart();
        }

        function toggleApplied(id) {
            jobData[id].applied = !jobData[id].applied;
            if (jobData[id].applied && jobData[id].status === '–ù–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω') {
                jobData[id].status = '–û—Ç–ø—Ä–∞–≤–ª–µ–Ω';
            }
            saveData();
            renderTable();
        }

        function updateStatus(id, status) {
            jobData[id].status = status;
            if (status !== '–ù–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω') {
                jobData[id].applied = true;
            }
            saveData();
            renderTable();
        }

        function updateNotes(id, notes) {
            jobData[id].notes = notes;
            saveData();
        }

        function updateStats() {
            const sent = jobData.filter(j => j.applied).length;
            const inProgress = jobData.filter(j => ['–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω', '–ò–Ω—Ç–µ—Ä–≤—å—é'].includes(j.status)).length;
            const rejected = jobData.filter(j => j.status === '–û—Ç–∫–∞–∑').length;
            const offers = jobData.filter(j => j.status === '–û—Ñ—Ñ–µ—Ä').length;

            document.getElementById('sentCount').textContent = sent;
            document.getElementById('inProgressCount').textContent = inProgress;
            document.getElementById('rejectedCount').textContent = rejected;
            document.getElementById('offerCount').textContent = offers;
            document.getElementById('totalCompanies').textContent = jobData.length;
        }

        let chart;

        function updateChart() {
            const ctx = document.getElementById('statusChart').getContext('2d');
            
            const statusCounts = {
                '–ù–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω': jobData.filter(j => j.status === '–ù–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω').length,
                '–û—Ç–ø—Ä–∞–≤–ª–µ–Ω': jobData.filter(j => j.status === '–û—Ç–ø—Ä–∞–≤–ª–µ–Ω').length,
                '–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω': jobData.filter(j => j.status === '–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω').length,
                '–ò–Ω—Ç–µ—Ä–≤—å—é': jobData.filter(j => j.status === '–ò–Ω—Ç–µ—Ä–≤—å—é').length,
                '–û—Ñ—Ñ–µ—Ä': jobData.filter(j => j.status === '–û—Ñ—Ñ–µ—Ä').length,
                '–û—Ç–∫–∞–∑': jobData.filter(j => j.status === '–û—Ç–∫–∞–∑').length
            };

            if (chart) {
                chart.destroy();
            }

            chart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(statusCounts),
                    datasets: [{
                        data: Object.values(statusCounts),
                        backgroundColor: [
                            '#e8eaf6',
                            '#e1f5fe',
                            '#fff3e0',
                            '#fff9c4',
                            '#c8e6c9',
                            '#ffcdd2'
                        ],
                        borderColor: [
                            '#3f51b5',
                            '#0277bd',
                            '#f57c00',
                            '#f9a825',
                            '#2e7d32',
                            '#c62828'
                        ],
                        borderWidth: 3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function filterBySector(sector) {
            currentFilter = sector;
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            renderTable();
        }

        function exportToCSV() {
            let csv = '\ufeff–ö–æ–º–ø–∞–Ω–∏—è,–°–µ–∫—Ç–æ—Ä,–û—Ç–∫–ª–∏–∫ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω,–°—Ç–∞—Ç—É—Å,–ó–∞–º–µ—Ç–∫–∏\n';
            jobData.forEach(job => {
                csv += `"${job.name}","${job.sector}","${job.applied ? '–î–∞' : '–ù–µ—Ç'}","${job.status}","${job.notes}"\n`;
            });
            
            downloadFile(csv, '–¢—Ä–µ–∫–µ—Ä_–≤–∞–∫–∞–Ω—Å–∏–π.csv', 'text/csv;charset=utf-8;');
            showModal('CSV —Ñ–∞–π–ª —Å–∫–∞—á–∞–Ω! –û—Ç–∫—Ä–æ–π—Ç–µ –µ–≥–æ –≤ Google –¢–∞–±–ª–∏—Ü–∞—Ö –∏–ª–∏ Excel');
        }

        function exportToExcel() {
            const ws_data = [
                ['‚Ññ', '–ö–æ–º–ø–∞–Ω–∏—è', '–°–µ–∫—Ç–æ—Ä', '–û—Ç–∫–ª–∏–∫ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω', '–°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏', '–ó–∞–º–µ—Ç–∫–∏']
            ];
            
            jobData.forEach((job, index) => {
                ws_data.push([
                    index + 1,
                    job.name,
                    job.sector,
                    job.applied ? '–î–∞' : '–ù–µ—Ç',
                    job.status,
                    job.notes
                ]);
            });

            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.aoa_to_sheet(ws_data);
            
            ws['!cols'] = [
                {wch: 5},
                {wch: 25},
                {wch: 15},
                {wch: 18},
                {wch: 15},
                {wch: 30}
            ];

            XLSX.utils.book_append_sheet(wb, ws, "–¢—Ä–µ–∫–µ—Ä –≤–∞–∫–∞–Ω—Å–∏–π");
            XLSX.writeFile(wb, "–¢—Ä–µ–∫–µ—Ä_–≤–∞–∫–∞–Ω—Å–∏–π.xlsx");
            
            showModal('Excel —Ñ–∞–π–ª —Å–∫–∞—á–∞–Ω! –û—Ç–∫—Ä–æ–π—Ç–µ –µ–≥–æ –≤ Microsoft Excel –∏–ª–∏ Google Sheets');
        }

        function exportToWord() {
            let html = `
                <html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word'>
                <head><meta charset='utf-8'><title>–¢—Ä–µ–∫–µ—Ä –≤–∞–∫–∞–Ω—Å–∏–π</title></head>
                <body>
                <h1>–¢—Ä–µ–∫–µ—Ä –æ—Ç–∫–ª–∏–∫–æ–≤ –Ω–∞ –≤–∞–∫–∞–Ω—Å–∏–∏</h1>
                <p>–î–∞—Ç–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞: ${new Date().toLocaleDateString('ru-RU')}</p>
                <table border="1" cellpadding="8" cellspacing="0" style="border-collapse: collapse; width: 100%;">
                <thead>
                    <tr style="background-color: #667eea; color: white;">
                        <th>‚Ññ</th>
                        <th>–ö–æ–º–ø–∞–Ω–∏—è</th>
                        <th>–°–µ–∫—Ç–æ—Ä</th>
                        <th>–û—Ç–∫–ª–∏–∫</th>
                        <th>–°—Ç–∞—Ç—É—Å</th>
                        <th>–ó–∞–º–µ—Ç–∫–∏</th>
                    </tr>
                </thead>
                <tbody>
            `;
            
            jobData.forEach((job, index) => {
                html += `
                    <tr>
                        <td>${index + 1}</td>
                        <td><strong>${job.name}</strong></td>
                        <td>${job.sector}</td>
                        <td>${job.applied ? '‚úì' : '‚Äî'}</td>
                        <td>${job.status}</td>
                        <td>${job.notes}</td>
                    </tr>
                `;
            });
            
            html += '</tbody></table></body></html>';
            
            const blob = new Blob(['\ufeff', html], {
                type: 'application/msword'
            });
            
            downloadFile(blob, '–¢—Ä–µ–∫–µ—Ä_–≤–∞–∫–∞–Ω—Å–∏–π.doc', null);
            showModal('Word –¥–æ–∫—É–º–µ–Ω—Ç —Å–∫–∞—á–∞–Ω! –û—Ç–∫—Ä–æ–π—Ç–µ –µ–≥–æ –≤ Microsoft Word –∏–ª–∏ Google Docs');
        }

        function printToPDF() {
            window.print();
            showModal('–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ "–ü–µ—á–∞—Ç—å -> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫ PDF" –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è PDF —Ñ–∞–π–ª–∞');
        }

        function downloadFile(content, fileName, mimeType) {
            const blob = typeof content === 'string' ? new Blob([content], { type: mimeType }) : content;
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', fileName);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function showModal(message) {
            document.getElementById('modalMessage').textContent = message;
            document.getElementById('exportModal').classList.add('active');
        }

        function closeModal() {
            document.getElementById('exportModal').classList.remove('active');
        }
function addNewCompany() {
    const name = document.getElementById('newCompanyName').value.trim();
    const sector = document.getElementById('newCompanySector').value.trim();

    if (!name || !sector) {
        alert("–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ —Å–µ–∫—Ç–æ—Ä –∫–æ–º–ø–∞–Ω–∏–∏!");
        return;
    }

    const newCompany = {
        id: jobData.length,
        name,
        sector,
        applied: false,
        status: '–ù–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω',
        notes: ''
    };

    jobData.push(newCompany);

    jobData.sort((a, b) => a.sector.localeCompare(b.sector));

    jobData.forEach((job, index) => job.id = index);

    saveData();
    renderTable();

    document.getElementById('newCompanyName').value = '';
    document.getElementById('newCompanySector').value = '';
}function deleteCompany(id) {
    const company = jobData.find(j => j.id === id);
    
    if (confirm(`–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –∫–æ–º–ø–∞–Ω–∏—é "${company.name}"?`)) {
        jobData = jobData.filter(j => j.id !== id);
        
        jobData.forEach((job, index) => job.id = index);
        
        saveData();
        renderTable();
    }
}

        initializeData();
        renderTable();
    </script>
</body>
</html>